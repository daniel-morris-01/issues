name: Generate issue dashboard

on:
  issues:
jobs:
  generate-issues-html:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository
        uses: actions/checkout@v4
      - name: Check out GitHub Pages branch
        uses: actions/checkout@v4
        with:
          ref: 'gh-pages'
          path: 'out'
      - name: Create pages
        run: |
            mkdir -p out/docs
      - name: 'Generate Dashboard'
        uses: ethomson/issue-dashboard@v1
        with:
          config: |
            title: 'Dashboard'
            output:
              format: html
              filename: 'out/docs/dashboard.html'
            sections:
              - title: 'Open Issues by Type'
                description: 'Queries of issues by type, using their label.'
                widgets:
                - type: 'number'
                  title: 'Bug'
                  issue_query: 'repo:daniel-morris-01/issues is:open is:issue label:bug'
                  color: 'red'
                - type: 'table'
                  title: 'Issues Tier 1'
                  issue_query: 'repo:daniel-morris-01/issues is:open is:issue label:needs-triage sort:created-asc'
                - type: 'table'
                  title: 'Issues es dri'
                  issue_query: 'repo:daniel-morris-01/issues is:open is:issue label:fab-es-dri sort:created-asc'

              
          token: ${{ github.token }}
      - name: Publish Documentation
        run: |
            git add .
            git config user.name github-actions
            git config user.email github-actions@github.com
            git commit -m 'Documentation update' --allow-empty
            git push origin gh-pages
        working-directory: out